import streamlit as st
from bands_indices import compute_bands_and_indices

uploaded_file = st.file_uploader("Upload satellite image", type=["tif", "tiff"])
lat = st.number_input("Latitude (N)", value=0.0)
lon = st.number_input("Longitude (E)", value=0.0)
width_m = st.number_input("Width (m)", value=10.0)
height_m = st.number_input("Height (m)", value=12.0)

if uploaded_file is not None:
    # บันทึกไฟล์ชั่วคราว
    with open("temp_image.tif", "wb") as f:
        f.write(uploaded_file.read())

    bands, indices, agb = compute_bands_and_indices("temp_image.tif", lat, lon, width_m, height_m)

    st.subheader("Spectral Bands")
    st.table(bands)

    st.subheader("Indices")
    st.table(indices)

    st.subheader("Predicted AGB")
    st.markdown(f"<h2 style='color:green'>{agb:.3f} ton/ha</h2>", unsafe_allow_html=True)
