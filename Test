def theos_style_visualization(image):
    # Sun geometry จาก metadata THEOS
    sun_elevation_deg = 44.344240
    incidence_deg = 3.046793

    sun_elevation_rad = ee.Number(sun_elevation_deg).multiply(3.141592653589793).divide(180)
    incidence_rad = ee.Number(incidence_deg).multiply(3.141592653589793).divide(180)

    # Lambertian + Incidence correction
    correction_factor = incidence_rad.cos().divide(sun_elevation_rad.sin())

    corrected = image.multiply(correction_factor)

    # Scale กลับให้เหมือน THEOS DN (0–1023)
    return corrected.visualize(
        bands=['B4', 'B3', 'B2'],
        min=0,
        max=1023,
        gamma=1.0
    )
